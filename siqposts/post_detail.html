{% extends 'base.html' %}
{% load static %}

{% block content %}
  <h1>{{ post.title }}</h1>
  <p><strong>By:</strong> {{ post.author.username }} | <em>{{ post.created_at }}</em></p>

  {% if post.image %}
    <img src="{{ post.image.url }}" alt="Post image" style="max-width: 100%; margin-bottom: 1rem;">
  {% endif %}

  <p>{{ post.content }}</p>

  <!-- Like Button -->
  <form method="post" action="{% url 'toggle_like' post.pk %}">
    {% csrf_token %}
    <button type="submit">
      {% if user.is_authenticated and post.likes.filter(user=user).exists %}
        ‚ù§Ô∏è Unlike
      {% else %}
        ü§ç Like
      {% endif %}
    </button>
    <span>{{ post.likes.count }} likes</span>
  </form>

  <hr>

  <!-- Comments Section -->
  <h3>Comments</h3>
  <ul>
    {% for comment in comments %}
      <li><strong>{{ comment.author.username }}</strong>: {{ comment.content }} <em>({{ comment.created_at }})</em></li>
    {% empty %}
      <li>No comments yet.</li>
    {% endfor %}
  </ul>

  {% if user.is_authenticated %}
    <form method="post">
      {% csrf_token %}
      <textarea name="content" rows="3" placeholder="Add a comment..." required></textarea><br>
      <button type="submit">Post Comment</button>
    </form>
  {% else %}
    <p><a href="{% url 'login' %}">Log in</a> to comment or like.</p>
  {% endif %}
{% endblock %}
